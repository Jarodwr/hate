https://github.com/deepmind/strict/blob/master/strict.lua